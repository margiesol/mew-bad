{% load static %}

<!DOCTYPE html>
<html>
<head>
	<title>MEW System</title>
	<link rel="stylesheet" href="{% static '/css/style.css' %}">
</head>

<body>
	{% if request.session.user_id %}
		<!-- Top header bar (hamburger sits beside tabs in the same row) -->
		<header class="topbar">
			<button class="hamburger" id="sidebarToggle" type="button" aria-label="Open menu" aria-expanded="false">
				<span></span><span></span><span></span>
			</button>
			{% block header_tabs %}{% endblock %}
		</header>

		<!-- Dark overlay -->
		<div class="overlay" id="overlay"></div>

		<!-- Sidebar -->
		<aside class="sidebar" id="sidebar" aria-hidden="true">
			<div class="sidebar-header">
				<div class="sidebar-title">MEW</div>
				<button class="sidebar-close" id="closeSidebar" type="button" aria-label="Close">âœ•</button>
			</div>

			<a class="sidebar-link" href="{% url 'main_page' %}">Invoice List</a>
			<a class="sidebar-link" href="{% url 'create_invoice' %}">Create Invoice</a>
			<a class="sidebar-link" href="{% url 'profiles' %}">Profiles</a>

			<hr style="border-color: rgba(255,255,255,0.3);">

			<a class="sidebar-link" href="?logout=true" style="color:#ffc107;">Logout</a>
		</aside>
	{% endif %}

	<!-- Page Content -->
	<main>
		{% block content %}{% endblock %}
	</main>

	<!-- Sidebar Script -->
	<script>
		(function () {
			const sidebar = document.getElementById("sidebar");
			const overlay = document.getElementById("overlay");
			const toggleBtn = document.getElementById("sidebarToggle");
			const closeBtn = document.getElementById("closeSidebar");

			if (!sidebar || !overlay || !toggleBtn) return;

			function openSidebar() {
				sidebar.classList.add("active");
				overlay.classList.add("active");
				toggleBtn.setAttribute("aria-expanded", "true");
				sidebar.setAttribute("aria-hidden", "false");
			}

			function closeSidebar() {
				sidebar.classList.remove("active");
				overlay.classList.remove("active");
				toggleBtn.setAttribute("aria-expanded", "false");
				sidebar.setAttribute("aria-hidden", "true");
			}

			toggleBtn.addEventListener("click", (e) => {
				e.stopPropagation();
				if (sidebar.classList.contains("active")) closeSidebar();
				else openSidebar();
			});

			closeBtn && closeBtn.addEventListener("click", closeSidebar);
			overlay.addEventListener("click", closeSidebar);

			document.addEventListener("keydown", (e) => {
				if (e.key === "Escape") closeSidebar();
			});
		})();
	</script>
</body>
</html>